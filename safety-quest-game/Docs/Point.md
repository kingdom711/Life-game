# 포인트 시스템 (Point System)

## 개요

포인트는 게임 내 주요 화폐로, 안전 활동을 통해 획득하고 아이템 구매 및 강화에 사용됩니다. 모든 포인트 획득 및 소비 내역은 히스토리에 기록되어 추적 가능합니다.

---

## 1. 포인트 획득 (Point Acquisition)

### 1.1 퀘스트 완료 보상

#### 일간 퀘스트 (Daily Quests)

| 퀘스트 ID | 퀘스트명 | 포인트 보상 | 대상 역할 |
|---------|---------|-----------|----------|
| `daily_hazard_1` | 찾아라 위험! | 0P | technician (HazardQuestModal에서 직접 지급) |
| `daily_checklist_1` | 오늘의 안전 점검 | 100P | technician |
| `daily_photo_1` | 현장 포착: 위험을 찾아라 | 150P | technician |
| `daily_review_1` | 꼼꼼한 관리자 | 200P | supervisor |
| `daily_safety_1` | 일일 위험 요소 제거 | 250P | safetyManager |
| `daily_login_1` | 출근 도장 쾅! | 0P | all (출석 체크 보상만 지급) |

**특수 케이스: 위험요인 발굴 퀘스트**
- 퀘스트 완료 보상: 0P (중복 지급 방지)
- 실제 보상은 HazardQuestModal에서 직접 지급:
  - 기본 보상: 100P
  - 발견한 위험요인 개당 추가 보상: +10P
  - **최종 보상 = 100P + (발견한 위험요인 수 × 10P)**
- 퀘스트 완료 시 추가 포인트는 지급되지 않음

#### 주간 퀘스트 (Weekly Quests)

| 퀘스트 ID | 퀘스트명 | 포인트 보상 | 대상 역할 |
|---------|---------|-----------|----------|
| `weekly_checklist_1` | 성실한 안전 지킴이 | 1,000P | technician |
| `weekly_complete_daily` | 7일의 기적 | 1,500P | all |
| `weekly_safety_1` | 위험 제로 챌린지 | 2,000P | safetyManager |
| `weekly_approval_rate` | 완벽한 관리 감독 | 1,200P | supervisor |
| `weekly_photo_collection` | 현장 기록 전문가 | 800P | technician |

#### 월간 퀘스트 (Monthly Quests)

| 퀘스트 ID | 퀘스트명 | 포인트 보상 | 대상 역할 |
|---------|---------|-----------|----------|
| `monthly_checklist_master` | 전설의 체크리스트 마스터 | 5,000P | technician |
| `monthly_perfect_weeks` | 4주 연속 퍼펙트 클리어 | 10,000P | all |
| `monthly_ai_accuracy` | AI 안전 분석가 | 8,000P | safetyManager |
| `monthly_zero_accident` | 무재해 30일 달성 | 15,000P | all |
| `monthly_mentor` | 최고의 멘토 | 7,000P | supervisor |

### 1.2 출석 체크 보상

#### 일일 출석 보상
- **기본 보상**: 20P (1회만 지급)
- **지급 조건**: 매일 1회 출석 체크 완료
- **연속 출석 보너스**: 7일마다 추가 100P 보너스
  - 예: 7일째 출석 시 → 20P (기본) + 100P (보너스) = 120P
  - 예: 14일째 출석 시 → 20P (기본) + 100P (보너스) = 120P

**출석 보상 계산식:**
```
기본 보상 = 20P
보너스 = (연속 출석 일수 % 7 === 0) ? 100P : 0P
총 보상 = 기본 보상 + 보너스
```

**중요 사항:**
- 출석 체크 시 포인트는 `checkAttendance` 함수에서만 지급됩니다
- 일일 퀘스트 "출근 도장 쾅!"의 포인트 보상은 0P입니다 (퀘스트 완료 시 추가 포인트 지급 없음)
- 출석 체크와 동시에 월간 출석 기록이 자동으로 업데이트됩니다
- 출석 체크와 동시에 일일 퀘스트 진행도가 업데이트됩니다 (보상 없이 완료 처리만)

#### 월간 출석 보상

월간 출석 일수에 따라 추가 보상을 받을 수 있습니다.

| 출석 일수 | 보상 타입 | 포인트 보상 | 비고 |
|---------|---------|-----------|------|
| 1일 | 포인트 | 30P | - |
| 2일 | 포인트 | 40P | - |
| 3일 | 포인트 | 50P | - |
| 4일 | 포인트 | 60P | - |
| 5일 | 포인트 | 70P | - |
| 6일 | 포인트 | 80P | - |
| 7일 | 포인트 | 90P | - |
| 8일 | 포인트 | 100P | - |
| 9일 | 아이템 상자 | - | 일반 아이템 상자 |
| 10일 | 포인트 | 150P | - |
| 11일 | 포인트 | 200P | - |
| 12일 | 아이템 상자 | - | 고급 아이템 상자 |
| 13일 | 포인트 | 250P | - |
| 14일 | 포인트 | 300P | - |
| 15일 | 아이템 상자 | - | 희귀 아이템 상자 |
| 16일 | 포인트 | 350P | - |
| 17일 | 포인트 | 400P | - |
| 18일 | 포인트 | 450P | - |
| 19일 | 아이템 상자 | - | 전설 아이템 상자 |
| 20일 | 포인트 | 500P | - |
| 21일 | 포인트 | 600P | - |
| 22일 | 포인트 | 700P | - |
| 23일 | 포인트 | 800P | - |
| 24일 | 포인트 | 1,000P | - |
| 25일 | 아이템 상자 | - | 특별 아이템 상자 |
| 26일 | 대보상 | 2,000P | + 전설 아이템 |

### 1.3 레벨업 보상

레벨업 시 포인트를 획득할 수 있습니다.

**레벨업 보상 계산식:**
```
보상 = 레벨 × 100P
```

**예시:**
- 레벨 2 달성: 200P
- 레벨 5 달성: 500P
- 레벨 10 달성: 1,000P
- 레벨 15 달성: 1,500P

---

## 2. 포인트 보너스 시스템 (Point Bonus System)

### 2.1 아이템 포인트 보너스

착용한 아이템의 `pointBoost` 스탯에 따라 획득하는 포인트에 보너스가 적용됩니다.

**보너스 계산식:**
```
최종 포인트 = 기본 포인트 × (1 + pointBoost% / 100)
```

**예시:**
- 기본 포인트: 100P
- 착용 아이템의 총 pointBoost: 20%
- 최종 획득 포인트: 100P × 1.2 = 120P

### 2.2 아이템별 포인트 보너스

#### 일반 (Common) 등급
- 포인트 보너스: 3~6%

#### 고급 (Rare) 등급
- 포인트 보너스: 6~10%

#### 희귀 (Epic) 등급
- 포인트 보너스: 10~12%

#### 전설 (Legendary) 등급
- 포인트 보너스: 18~25%

**참고:** 세트 효과를 착용하면 추가 보너스를 받을 수 있습니다.

---

## 3. 포인트 소비 (Point Consumption)

### 3.1 아이템 구매

상점에서 안전용품 아이템을 포인트로 구매할 수 있습니다.

#### 아이템 가격표

##### 안전모 (Helmet)
| 아이템명 | 등급 | 가격 |
|---------|------|------|
| 기본 안전모 | Common | 150P |
| 통풍형 안전모 | Rare | 500P |
| 방한 안전모 | Epic | 900P |
| 스마트 안전모 | Legendary | 2,000P |

##### 안전조끼 (Vest)
| 아이템명 | 등급 | 가격 |
|---------|------|------|
| 형광 안전조끼 | Common | 100P |
| 반사띠 안전조끼 | Rare | 400P |
| LED 안전조끼 | Epic | 800P |

##### 안전장갑 (Gloves)
| 아이템명 | 등급 | 가격 |
|---------|------|------|
| 작업용 장갑 | Common | 120P |
| 방수 안전장갑 | Rare | 450P |
| 절연 안전장갑 | Epic | 1,000P |

##### 안전화 (Shoes)
| 아이템명 | 등급 | 가격 |
|---------|------|------|
| 기본 안전화 | Common | 200P |
| 미끄럼 방지 안전화 | Rare | 600P |
| 방한 안전화 | Epic | 1,100P |
| 스마트 안전화 | Legendary | 2,500P |

##### 보안경 (Glasses)
| 아이템명 | 등급 | 가격 |
|---------|------|------|
| 기본 보안경 | Common | 150P |
| 김서림 방지 보안경 | Rare | 500P |
| 편광 보안경 | Epic | 950P |

##### 안전벨트 (Belt)
| 아이템명 | 등급 | 가격 |
|---------|------|------|
| 작업용 안전벨트 | Common | 300P |
| 추락방지 안전벨트 | Rare | 700P |
| 스마트 안전벨트 | Legendary | 1,800P |

##### 방진마스크 (Mask)
| 아이템명 | 등급 | 가격 |
|---------|------|------|
| 일반 방진마스크 | Common | 180P |
| 활성탄 방진마스크 | Rare | 550P |
| 전동 송풍 마스크 | Epic | 1,200P |

**구매 규칙:**
- 이미 보유한 아이템은 재구매 불가
- 포인트가 부족하면 구매 불가
- 구매 즉시 인벤토리에 추가됨

### 3.2 검교정(강화) 비용

아이템을 검교정하여 강화할 수 있으며, 등급과 현재 레벨에 따라 비용이 결정됩니다.

#### 검교정 비용 계산식

```
검교정 비용 = 기본 비용 × (현재 레벨 + 1)
```

#### 등급별 검교정 설정

##### 일반 (Common) 등급
- 최대 레벨: 5
- 레벨당 기본 비용: 200P
- 레벨 0 → 1: 200P × 1 = **200P**
- 레벨 1 → 2: 200P × 2 = **400P**
- 레벨 2 → 3: 200P × 3 = **600P**
- 레벨 3 → 4: 200P × 4 = **800P**
- 레벨 4 → 5: 200P × 5 = **1,000P**

##### 고급 (Rare) 등급
- 최대 레벨: 7
- 레벨당 기본 비용: 400P
- 레벨 0 → 1: 400P × 1 = **400P**
- 레벨 1 → 2: 400P × 2 = **800P**
- 레벨 2 → 3: 400P × 3 = **1,200P**
- 레벨 3 → 4: 400P × 4 = **1,600P**
- 레벨 4 → 5: 400P × 5 = **2,000P**
- 레벨 5 → 6: 400P × 6 = **2,400P**
- 레벨 6 → 7: 400P × 7 = **2,800P**

##### 희귀 (Epic) 등급
- 최대 레벨: 10
- 레벨당 기본 비용: 600P
- 레벨 0 → 1: 600P × 1 = **600P**
- 레벨 1 → 2: 600P × 2 = **1,200P**
- 레벨 2 → 3: 600P × 3 = **1,800P**
- 레벨 3 → 4: 600P × 4 = **2,400P**
- 레벨 4 → 5: 600P × 5 = **3,000P**
- 레벨 5 → 6: 600P × 6 = **3,600P**
- 레벨 6 → 7: 600P × 7 = **4,200P**
- 레벨 7 → 8: 600P × 8 = **4,800P**
- 레벨 8 → 9: 600P × 9 = **5,400P**
- 레벨 9 → 10: 600P × 10 = **6,000P**

##### 전설 (Legendary) 등급
- 최대 레벨: 15
- 레벨당 기본 비용: 1,000P
- 레벨 0 → 1: 1,000P × 1 = **1,000P**
- 레벨 1 → 2: 1,000P × 2 = **2,000P**
- 레벨 2 → 3: 1,000P × 3 = **3,000P**
- 레벨 3 → 4: 1,000P × 4 = **4,000P**
- 레벨 4 → 5: 1,000P × 5 = **5,000P**
- 레벨 5 → 6: 1,000P × 6 = **6,000P**
- 레벨 6 → 7: 1,000P × 7 = **7,000P**
- 레벨 7 → 8: 1,000P × 8 = **8,000P**
- 레벨 8 → 9: 1,000P × 9 = **9,000P**
- 레벨 9 → 10: 1,000P × 10 = **10,000P**
- 레벨 10 → 11: 1,000P × 11 = **11,000P**
- 레벨 11 → 12: 1,000P × 12 = **12,000P**
- 레벨 12 → 13: 1,000P × 13 = **13,000P**
- 레벨 13 → 14: 1,000P × 14 = **14,000P**
- 레벨 14 → 15: 1,000P × 15 = **15,000P**

**검교정 규칙:**
- 검교정은 성공/실패 확률이 있음 (레벨이 높을수록 성공률 감소)
- 실패해도 포인트는 소비됨
- 최대 레벨에 도달하면 더 이상 검교정 불가
- 포인트가 부족하면 검교정 불가

---

## 4. 포인트 히스토리 시스템

### 4.1 히스토리 기록

모든 포인트 획득 및 소비 내역은 자동으로 히스토리에 기록됩니다.

**기록되는 정보:**
- 포인트 양 (양수: 획득, 음수: 소비)
- 획득/소비 경로 (source)
- 상세 정보 (sourceDetail)
- 타임스탬프
- 거래 후 잔액

### 4.2 히스토리 조회

- 최근 100개 내역 조회 가능
- 최대 500개까지 저장 (초과 시 오래된 항목 자동 삭제)
- 소스별 필터링 가능
- 소스별 총합 통계 제공

### 4.3 히스토리 소스 분류

| 소스 | 설명 |
|------|------|
| 퀘스트 완료 | 일간/주간/월간 퀘스트 완료 |
| 출석 체크 | 일일 출석 체크 |
| 출석 보너스 | 연속 출석 보너스 (7일마다) |
| 월간 출석 보상 | 월간 출석 일수별 보상 |
| 레벨업 보상 | 레벨 달성 보상 |
| 기타 | 기타 경로 (현재 미사용) |

---

## 5. 포인트 관리 함수

### 5.1 획득 함수

```javascript
// 기본 포인트 추가
points.add(amount, source, sourceDetail)

// 보너스 적용 포인트 추가 (아이템 보너스 포함)
addPoints(basePoints, questType, source, sourceDetail)
```

### 5.2 소비 함수

```javascript
// 포인트 차감
points.subtract(amount, source, sourceDetail)
```

### 5.3 조회 함수

```javascript
// 현재 포인트 조회
points.get()

// 구매 가능 여부 확인
points.canAfford(amount)
```

---

## 6. 포인트 획득 전략

### 6.1 일일 최대 획득 가능 포인트

**기본 활동:**
- 일간 퀘스트 완료: 최대 850P (모든 퀘스트 완료 시)
- 출석 체크: 20P (보너스 제외)
- 위험요인 발굴: 100P + (발견 수 × 10P)

**보너스:**
- 아이템 포인트 보너스: 획득 포인트의 최대 25% 추가
- 연속 출석 보너스: 7일마다 100P

### 6.2 효율적인 포인트 획득 팁

1. **일간 퀘스트 완료**: 매일 모든 일간 퀘스트를 완료하여 안정적인 포인트 획득
2. **출석 체크**: 매일 출석하여 연속 출석 보너스 획득
3. **아이템 구매**: 포인트 보너스가 높은 아이템을 우선 구매
4. **세트 효과**: 세트 아이템을 착용하여 추가 보너스 획득
5. **주간/월간 퀘스트**: 장기적인 목표를 설정하여 대량 포인트 획득

---

## 7. 포인트 소비 전략

### 7.1 우선순위

1. **필수 아이템 구매**: 포인트 보너스가 높은 아이템 우선
2. **세트 완성**: 세트 효과를 위한 아이템 구매
3. **검교정**: 고급 아이템의 검교정으로 성능 향상

### 7.2 검교정 효율

- 일반 등급: 저렴하지만 최대 레벨이 낮음
- 고급 등급: 중간 비용, 중간 성능
- 희귀 등급: 높은 비용, 높은 성능
- 전설 등급: 매우 높은 비용, 최고 성능

**권장사항:**
- 초반: 일반/고급 아이템으로 시작
- 중반: 희귀 아이템 구매 및 검교정
- 후반: 전설 아이템 구매 및 최대 레벨 검교정

---

## 8. 참고사항

### 8.1 포인트 보너스 적용 범위

포인트 보너스는 다음 경로에만 적용됩니다:
- 퀘스트 완료 보상
- 출석 체크 보상
- 위험요인 발굴 보상

다음 경로에는 보너스가 적용되지 않습니다:
- 월간 출석 보상
- 레벨업 보상

### 8.2 포인트 제한

- 포인트는 음수가 될 수 없음 (최소 0P)
- 포인트는 무제한으로 보유 가능
- 포인트는 계정별로 독립적으로 관리됨

### 8.3 데이터 저장

- 포인트 및 히스토리는 LocalStorage에 저장됨
- 브라우저 데이터 삭제 시 포인트 정보도 삭제됨
- 백엔드 연동 시 서버에 동기화됨

---

## 9. 변경 이력

- **2024-12-XX**: 포인트 히스토리 시스템 추가
- **2024-12-XX**: 포인트 보너스 시스템 개선
- **2024-12-XX**: 검교정 비용 시스템 구현

---

## 10. 관련 문서

- [아이템 시스템 2.0](./아이템_시스템2.0.md)
- [출석 시스템](./ATTENDANCE_SYSTEM.md)
- [레벨 시스템](./LEVEL_SYSTEM.md)
- [퀘스트 시스템](./GPT-SRS-V3.md)

