# μ•„μ΄ν… μ‹μ¤ν… 2.0 - μ¤νƒ― λ° κ²€κµμ •(κ°•ν™”) λ΅μ§

> **μ‘μ„±μΌ**: 2024-12-23  
> **λ²„μ „**: 2.0.0  
> **μƒνƒ**: β… κµ¬ν„ μ™„λ£

---

## π“‹ κ°μ”

### κ°λ° λ©ν‘ λ° κ²μ΄λ―Έν”ΌμΌ€μ΄μ… μ „λµ

**ν•µμ‹¬ λ©μ **: λ‹¨μ μΉμ¥μ©(Cosmetic) μ•„μ΄ν…μ„ **κΈ°λ¥μ„± μ¥λΉ„(Functional Gear)**λ΅ μ „ν™ν•μ—¬, μ‚¬μ©μμ μ¥κΈ°μ μΈ μ„±μ¥ μ•κµ¬ μκ·Ή λ° ν¬μΈνΈ(P) μ†λΉ„μ²(Sink) ν™•λ³΄.

### λ©”νƒ€ κ²μ„ μ”μ† (Identity-Based Progression)

| μ”μ† | μ„¤λ… |
|------|------|
| **κ²€κµμ •(Calibration)** | RPGμ 'κ°•ν™”' μ‹μ¤ν…μ„ μ‚°μ—… μ•μ „ μ©μ–΄μΈ 'κ²€κµμ •'μΌλ΅ μ¬ν•΄μ„. ν¬μΈνΈλ¥Ό μ†λ¨ν•μ—¬ μ¥λΉ„μ μ„±λ¥(λ³΄μƒ ν¨μ¨)μ„ μµμ ν™”ν•¨. |
| **μ•μ „ μ¤νƒ―(Safety Stats)** | μ‹¤μ  μ•μ „ μ κ²€ μλ¬΄λ” κ±΄λ“λ¦¬μ§€ μ•λ, λ³΄μƒ νλ“λ‰(Point/XP)κ³Ό νΈμμ„±(Streak Protection)μ— κ΄€μ—¬ν•λ” μ¤νƒ― λ¶€μ—¬. |
| **μ„ΈνΈ ν¨κ³Ό(Set Bonus)** | λ™μΌ μ„ΈνΈ μ•„μ΄ν…μ„ 2/4/7κ° μ¥μ°© μ‹ μ¶”κ°€ λ³΄λ„μ¤ μ¤νƒ― λ° μ‹κ° ν¨κ³Ό μ μ©. |

---

## π“ λ°μ΄ν„° λ¨λΈ λ° μ¤ν‚¤λ§

### A. Item Schema (Base Definition)

`src/data/itemsData.js`

```javascript
{
  id: "item_helmet_001",
  name: "Standard Safety Helmet",
  type: "HELMET",
  rarity: "RARE", // COMMON, RARE, EPIC, LEGENDARY
  
  // [New] κΈ°λ³Έ μ¤νƒ― μ •μ (Base Stats)
  baseStats: {
    pointBoost: 5,      // ν¬μΈνΈ νλ“λ‰ +5%
    xpAccelerator: 0,   // κ²½ν—μΉ νλ“λ‰ +0%
    streakSaver: 0      // μ¤νΈλ¦­ λ³΄νΈ ν™•λ¥  0%
  },
  
  // [New] κ²€κµμ •(κ°•ν™”) μ„¤μ •
  calibrationConfig: {
    maxLevel: 10,           // μµλ€ κ°•ν™” μμΉ
    costPerLevel: 500,      // κ°•ν™” 1νλ‹Ή μ†λ¨ ν¬μΈνΈ
    successRateBase: 0.9,   // μ΄κΈ° μ„±κ³µ ν™•λ¥  (90%)
    statIncrement: 1.5      // λ λ²¨λ‹Ή μ¤νƒ― μ¦κ°€ν­ (%)
  },
  
  // [New] μ„ΈνΈ ν¨κ³Ό ID
  setId: "set_neon_guardian",
  
  imageUrl: "/assets/items/helmet_rare.png"
}
```

### B. UserInventory Schema (Instance Data)

`src/utils/storage.js` - `userInventoryInstances`

μ‚¬μ©μκ°€ μ†μ ν• 'κ°λ³„ μ•„μ΄ν…'μ μƒνƒλ¥Ό μ¶”μ ν•©λ‹λ‹¤.

```javascript
{
  instanceId: "uuid_v4_generated",
  userId: "user_001",
  itemId: "item_helmet_001",  // Base Item μ°Έμ΅°
  
  // [New] ν„μ¬ μ„±μ¥ μƒνƒ
  currentCalibrationLevel: 3,  // ν„μ¬ +3κ°•
  
  // [New] μµμΆ… κ³„μ‚°λ ν™μ„± μ¤νƒ― (Base + Calibration Bonus)
  activeStats: {
    pointBoost: 9.5,     // 5 + (3 * 1.5)
    xpAccelerator: 0,
    streakSaver: 0
  },
  
  isEquipped: true,
  acquiredAt: "2024-12-24T10:00:00Z"
}
```

### C. Set Schema

`src/data/setsData.js`

```javascript
{
  id: "set_neon_guardian",
  name: "λ„¤μ¨ μνΈμ μ„ΈνΈ",
  bonuses: [
    {
      pieces: 2,
      stats: { pointBoost: 5, xpAccelerator: 0, streakSaver: 0 },
      description: "2μ„ΈνΈ ν¨κ³Ό: ν¬μΈνΈ νλ“λ‰ +5%"
    },
    {
      pieces: 4,
      stats: { pointBoost: 10, xpAccelerator: 5, streakSaver: 0 },
      description: "4μ„ΈνΈ ν¨κ³Ό: ν¬μΈνΈ νλ“λ‰ +10%, κ²½ν—μΉ νλ“λ‰ +5%"
    },
    {
      pieces: 7,
      stats: { pointBoost: 15, xpAccelerator: 10, streakSaver: 5 },
      description: "7μ„ΈνΈ ν¨κ³Ό: ν¬μΈνΈ νλ“λ‰ +15%, κ²½ν—μΉ νλ“λ‰ +10%, μ¤νΈλ¦­ λ³΄νΈ ν™•λ¥  +5%"
    }
  ],
  visualAura: "HOLOGRAM_SHIELD_V2"
}
```

---

## π”§ ν•µμ‹¬ μ„λΉ„μ¤ λ΅μ§

### A. κ²€κµμ • μ„λΉ„μ¤ (calibrationService.js)

```javascript
import { getItemById } from '../data/itemsData';
import { userInventoryInstances, points, userProfile } from './storage';

export const calibrateItem = (instanceId) => {
  const userId = userProfile.getName();
  const itemInstance = userInventoryInstances.getItemByInstanceId(userId, instanceId);
  const baseItem = getItemById(itemInstance.itemId);
  
  const { maxLevel, costPerLevel, successRateBase, statIncrement } = baseItem.calibrationConfig;
  
  // μµλ€ λ λ²¨ μ²΄ν¬
  if (itemInstance.currentCalibrationLevel >= maxLevel) {
    return { success: false, message: "μµλ€ λ λ²¨ λ„λ‹¬" };
  }
  
  // ν¬μΈνΈ μ²΄ν¬ λ° μ†λ¨
  if (!points.canAfford(costPerLevel)) {
    return { success: false, message: "ν¬μΈνΈ λ¶€μ΅±" };
  }
  points.subtract(costPerLevel);
  
  // μ„±κ³µ ν™•λ¥  κ³„μ‚° (λ λ²¨λ‹Ή -5%)
  const currentLevel = itemInstance.currentCalibrationLevel;
  const successRate = successRateBase - (currentLevel * 0.05);
  const isSuccess = Math.random() < successRate;
  
  if (isSuccess) {
    const newLevel = currentLevel + 1;
    const newActiveStats = {
      pointBoost: baseItem.baseStats.pointBoost + (newLevel * statIncrement),
      xpAccelerator: baseItem.baseStats.xpAccelerator + (newLevel * statIncrement),
      streakSaver: baseItem.baseStats.streakSaver + (newLevel * statIncrement)
    };
    
    userInventoryInstances.updateItem(userId, instanceId, {
      currentCalibrationLevel: newLevel,
      activeStats: newActiveStats
    });
    
    return { status: "success", isSuccess: true, newLevel, effect: "Visual_Success_Lime_Green" };
  }
  
  return { status: "success", isSuccess: false, effect: "Visual_Failure_Red" };
};
```

### B. μ¤νƒ― κ³„μ‚° λ΅μ§ (pointsCalculator.js)

```javascript
// μ „μ²΄ ν™μ„± μ¤νƒ― κ³„μ‚° (μ¥λΉ„ + μ„ΈνΈ ν¨κ³Ό)
export const getTotalActiveStats = () => {
  const userId = userProfile.getName();
  const equippedInstances = userInventoryInstances.getEquippedItemsByUserId(userId);
  
  let totalPointBoost = 0;
  let totalXpAccelerator = 0;
  let totalStreakSaver = 0;
  const equippedSetItems = {}; // { setId: count }
  
  // 1. κ°λ³„ μ•„μ΄ν… μ¤νƒ― ν•©μ‚°
  equippedInstances.forEach(instance => {
    const activeStats = calculateItemActiveStats(instance);
    totalPointBoost += activeStats.pointBoost;
    totalXpAccelerator += activeStats.xpAccelerator;
    totalStreakSaver += activeStats.streakSaver;
    
    const baseItem = getItemById(instance.itemId);
    if (baseItem?.setId) {
      equippedSetItems[baseItem.setId] = (equippedSetItems[baseItem.setId] || 0) + 1;
    }
  });
  
  // 2. μ„ΈνΈ ν¨κ³Ό μ¶”κ°€
  const activeSetBonuses = [];
  let visualAura = null;
  
  Object.entries(equippedSetItems).forEach(([setId, count]) => {
    const set = getSetById(setId);
    if (set) {
      set.bonuses.forEach(bonus => {
        if (count >= bonus.pieces) {
          totalPointBoost += bonus.stats.pointBoost;
          totalXpAccelerator += bonus.stats.xpAccelerator;
          totalStreakSaver += bonus.stats.streakSaver;
          activeSetBonuses.push(set.name);
          if (set.visualAura) visualAura = set.visualAura;
        }
      });
    }
  });
  
  return { totalPointBoost, totalXpAccelerator, totalStreakSaver, activeSetBonuses, visualAura };
};
```

---

## π API λ…μ„Έμ„ (RESTful Specification)

### A. μ¥λΉ„ κ²€κµμ • (κ°•ν™”) μ”μ²­

**Endpoint**: `POST /api/v1/inventory/calibrate`

**Description**: ν¬μΈνΈλ¥Ό μ†λ¨ν•μ—¬ μ•„μ΄ν…μ λ λ²¨μ„ μ¬λ¦¬κ³  μ¤νƒ―μ„ μ¬κ³„μ‚°ν•©λ‹λ‹¤.

**Request Body**:
```json
{
  "userId": "user_123",
  "instanceId": "uuid_of_user_item"
}
```

**Business Logic (Backend)**:
1. Userμ λ³΄μ  ν¬μΈνΈ μ”μ•΅ ν™•μΈ (λ¶€μ΅± μ‹ 402 Payment Required)
2. `calibrationConfig`μ μ„±κ³µ ν™•λ¥ (RNG) κ³„μ‚°
3. μ„±κ³µ μ‹: `currentCalibrationLevel` +1, `activeStats` μ¬κ³„μ‚°, ν¬μΈνΈ μ°¨κ°
4. μ‹¤ν¨ μ‹: ν¬μΈνΈλ§ μ°¨κ°

**Response (Success)**:
```json
{
  "status": "success",
  "newLevel": 4,
  "pointsConsumed": 500,
  "isSuccess": true,
  "effect": "Visual_Success_Lime_Green"
}
```

### B. μ „μ²΄ μ¤νƒ― μ΅°ν (HUD Displayμ©)

**Endpoint**: `GET /api/v1/user/{userId}/stats/active`

**Description**: ν„μ¬ μ¥μ°©λ λ¨λ“  μ¥λΉ„μ μ¤νƒ― ν•©κ³„λ¥Ό λ°ν™ν•©λ‹λ‹¤ (μ„ΈνΈ ν¨κ³Ό ν¬ν•¨).

**Response**:
```json
{
  "totalPointBoost": 15.5,
  "totalXpAccelerator": 5.0,
  "totalStreakSaver": 2.0,
  "activeSetBonuses": ["set_neon_guardian"],
  "visualAura": "HOLOGRAM_SHIELD_V2"
}
```

---

## π¨ UI/UX λ””μμΈ

### μ»¨μ…‰: "High-Tech Lab"

κΉ¨λ—ν• ν™”μ΄νΈ ν†¤ μ‹¤ν—μ‹¤μ—μ„ μ •λ°€ μ¥λΉ„λ¥Ό νλ‹ν•λ” λλ‚.

### κ²€κµμ • ν™”λ©΄ (CalibrationModal)

| μ”μ† | λ””μμΈ |
|------|--------|
| **λ°°κ²½** | Pure White (#FFFFFF) + Subtle Grid Pattern (#F0F0F0) |
| **μ•„μ΄ν… ν‘μ‹** | κ³µμ¤‘μ— λ¶€μ (Floating)ν•λ©° μ²μ²ν νμ „ |
| **μμΉ ν‘μ‹** | ν„μ¬ μ¤νƒ―(Black Text) β†’ μμƒ μ¤νƒ―(Cyan Neon Text + Blink Animation) |
| **κ°•ν™” λ²„νΌ** | "CALIBRATE [500 P]" - νΈλ²„ μ‹ Magenta Neon λΌμΈ |
| **μ„±κ³µ μ—°μ¶** | Bright Lime (#32CD32) νλ™ + "CALIBRATION COMPLETE" ν™€λ΅κ·Έλ¨ |

### μƒ‰μƒ ν”λ νΈ

| μ©λ„ | μƒ‰μƒ μ½”λ“ |
|------|-----------|
| Neon Cyan | `#00FFFF` |
| Neon Magenta | `#FF00FF` |
| Bright Lime (μ„±κ³µ) | `#32CD32` |
| Danger Red (μ‹¤ν¨) | `#FF4444` |
| Pure White | `#FFFFFF` |
| Grid Pattern | `#F0F0F0` |

---

## π“ νμΌ κµ¬μ΅°

```
src/
β”β”€β”€ data/
β”‚   β”β”€β”€ itemsData.js       # μ•„μ΄ν… μ •μ + baseStats, calibrationConfig
β”‚   β””β”€β”€ setsData.js        # μ„ΈνΈ ν¨κ³Ό μ •μ (NEW)
β”β”€β”€ utils/
β”‚   β”β”€β”€ storage.js         # userInventoryInstances μ¶”κ°€
β”‚   β”β”€β”€ calibrationService.js  # κ²€κµμ • λ΅μ§ (NEW)
β”‚   β”β”€β”€ pointsCalculator.js    # getTotalActiveStats() μ¶”κ°€
β”‚   β”β”€β”€ inventoryManager.js    # μΈμ¤ν„΄μ¤ κΈ°λ°μΌλ΅ λ¦¬ν©ν† λ§
β”‚   β””β”€β”€ dataMigration.js       # λ°μ΄ν„° λ§μ΄κ·Έλ μ΄μ… (NEW)
β”β”€β”€ components/
β”‚   β”β”€β”€ CalibrationModal.jsx   # κ²€κµμ • UI (NEW)
β”‚   β””β”€β”€ StatsHUD.jsx           # ν™μ„± μ¤νƒ― ν‘μ‹ (NEW)
β”β”€β”€ pages/
β”‚   β””β”€β”€ Inventory.jsx          # κ²€κµμ • λ²„νΌ ν†µν•©
β””β”€β”€ styles/
    β””β”€β”€ index.css              # Neon Lab μ¤νƒ€μΌ μ¶”κ°€
```

---

## π”„ λ°μ΄ν„° λ§μ΄κ·Έλ μ΄μ…

### κΈ°μ΅΄ λ°μ΄ν„° β†’ μ‹ κ· μ¤ν‚¤λ§ λ³€ν™

`dataMigration.js`κ°€ μ•± μ΄κΈ°ν™” μ‹ μλ™ μ‹¤ν–‰:

1. κΈ°μ΅΄ `inventory` λ°°μ—΄μ μ•„μ΄ν… β†’ `userInventoryInstances`λ΅ λ³€ν™
2. κΈ°μ΅΄ `equippedItems` κ°μ²΄ β†’ μΈμ¤ν„΄μ¤μ— `isEquipped: true` μ„¤μ •
3. `enhancementLevel` β†’ `currentCalibrationLevel`λ΅ λ§¤ν•‘
4. κΈ°λ³Έ μ¤νƒ― κ³„μ‚°ν•μ—¬ `activeStats` μ΄κΈ°ν™”
5. λ§μ΄κ·Έλ μ΄μ… μ™„λ£ ν›„ κΈ°μ΅΄ λ°μ΄ν„° μ •λ¦¬

---

## β… κµ¬ν„ μ™„λ£ ν•­λ©

| μμ—­ | νμΌ | μƒνƒ |
|------|------|------|
| λ°μ΄ν„° μ¤ν‚¤λ§ | `itemsData.js` | β… μ™„λ£ |
| μ„ΈνΈ ν¨κ³Ό | `setsData.js` | β… μ™„λ£ |
| μ¤ν† λ¦¬μ§€ | `storage.js` | β… μ™„λ£ |
| κ²€κµμ • μ„λΉ„μ¤ | `calibrationService.js` | β… μ™„λ£ |
| μ¤νƒ― κ³„μ‚° | `pointsCalculator.js` | β… μ™„λ£ |
| API λ μ΄μ–΄ | `inventoryApi.js` | β… μ™„λ£ |
| κ²€κµμ • λ¨λ‹¬ | `CalibrationModal.jsx` | β… μ™„λ£ |
| μ¤νƒ― HUD | `StatsHUD.jsx` | β… μ™„λ£ |
| μΈλ²¤ν† λ¦¬ νμ΄μ§€ | `Inventory.jsx` | β… μ™„λ£ |
| μ•„λ°”νƒ€ ν¨κ³Ό | `AvatarWindow.jsx` | β… μ™„λ£ |
| CSS μ¤νƒ€μΌ | `index.css` | β… μ™„λ£ |
| λ°μ΄ν„° λ§μ΄κ·Έλ μ΄μ… | `dataMigration.js` | β… μ™„λ£ |
| μΈλ²¤ν† λ¦¬ λ§¤λ‹μ € | `inventoryManager.js` | β… μ™„λ£ |

---

## π”® ν–¥ν›„ ν™•μ¥ κ°€λ¥μ„±

### 1. λ‚΄κµ¬λ„ μ‹μ¤ν… (λ―Έκµ¬ν„)
- `currentDurability`: μ‚¬μ©μ— λ”°λ¥Έ λ‚΄κµ¬λ„ κ°μ†
- μλ¦¬ κΈ°λ¥ μ¶”κ°€

### 2. κ°•ν™” λ³΄νΈκ¶
- μ‹¤ν¨ μ‹ λ λ²¨ ν•λ½ λ°©μ§€ μ•„μ΄ν…

### 3. μ¶•λ³µ/μ €μ£Ό μ‹μ¤ν…
- νΉμ ν¨κ³Ό λ¶€μ—¬

### 4. κ±°λμ†
- μ μ € κ°„ μ•„μ΄ν… κ±°λ

---

**λ§μ§€λ§‰ μ—…λ°μ΄νΈ**: 2024-12-23  
**μ‘μ„±μ**: κ°λ°ν€  
**λ²„μ „**: 2.0.0

